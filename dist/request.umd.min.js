!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue"),require("axios")):"function"==typeof define&&define.amd?define(["exports","vue","axios"],n):n((t=t||self).RequestHooks={},t.Vue,t.axios)}(this,(function(t,n,e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var r=function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function o(t,n,e,r){return new(e||(e=Promise))((function(o,a){function i(t){try{c(r.next(t))}catch(t){a(t)}}function u(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(i,u)}c((r=r.apply(t,n||[])).next())}))}function a(t,n){var e,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(t,i)}catch(t){a=[6,t],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function i(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,a=e.call(t),i=[];try{for(;(void 0===n||n-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return i}function u(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(i(arguments[n]));return t}var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,y=/^0o[0-7]+$/i,d=parseInt,p="object"==typeof c&&c&&c.Object===Object&&c,h="object"==typeof self&&self&&self.Object===Object&&self,v=p||h||Function("return this")(),b=Object.prototype.toString,g=Math.max,m=Math.min,j=function(){return v.Date.now()};function w(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function x(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==b.call(t)}(t))return NaN;if(w(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=w(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var e=l.test(t);return e||y.test(t)?d(t.slice(2),e?2:8):f.test(t)?NaN:+t}var O=function(t,n,e){var r,o,a,i,u,c,s=0,f=!1,l=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(n){var e=r,a=o;return r=o=void 0,s=n,i=t.apply(a,e)}function p(t){return s=t,u=setTimeout(v,n),f?d(t):i}function h(t){var e=t-c;return void 0===c||e>=n||e<0||l&&t-s>=a}function v(){var t=j();if(h(t))return b(t);u=setTimeout(v,function(t){var e=n-(t-c);return l?m(e,a-(t-s)):e}(t))}function b(t){return u=void 0,y&&r?d(t):(r=o=void 0,i)}function O(){var t=j(),e=h(t);if(r=arguments,o=this,c=t,e){if(void 0===u)return p(c);if(l)return u=setTimeout(v,n),d(c)}return void 0===u&&(u=setTimeout(v,n)),i}return n=x(n)||0,w(e)&&(f=!!e.leading,a=(l="maxWait"in e)?g(x(e.maxWait)||0,n):a,y="trailing"in e?!!e.trailing:y),O.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},O.flush=function(){return void 0===u?i:b(j())},O},T=/^\s+|\s+$/g,E=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,S=/^0o[0-7]+$/i,A=parseInt,K="object"==typeof c&&c&&c.Object===Object&&c,P="object"==typeof self&&self&&self.Object===Object&&self,N=K||P||Function("return this")(),$=Object.prototype.toString,D=Math.max,F=Math.min,G=function(){return N.Date.now()};function M(t,n,e){var r,o,a,i,u,c,s=0,f=!1,l=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(n){var e=r,a=o;return r=o=void 0,s=n,i=t.apply(a,e)}function p(t){return s=t,u=setTimeout(v,n),f?d(t):i}function h(t){var e=t-c;return void 0===c||e>=n||e<0||l&&t-s>=a}function v(){var t=G();if(h(t))return b(t);u=setTimeout(v,function(t){var e=n-(t-c);return l?F(e,a-(t-s)):e}(t))}function b(t){return u=void 0,y&&r?d(t):(r=o=void 0,i)}function g(){var t=G(),e=h(t);if(r=arguments,o=this,c=t,e){if(void 0===u)return p(c);if(l)return u=setTimeout(v,n),d(c)}return void 0===u&&(u=setTimeout(v,n)),i}return n=q(n)||0,W(e)&&(f=!!e.leading,a=(l="maxWait"in e)?D(q(e.maxWait)||0,n):a,y="trailing"in e?!!e.trailing:y),g.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},g.flush=function(){return void 0===u?i:b(G())},g}function W(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function q(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==$.call(t)}(t))return NaN;if(W(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=W(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(T,"");var e=k.test(t);return e||S.test(t)?A(t.slice(2),e?2:8):E.test(t)?NaN:+t}var R,I,_,C=function(t,n,e){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return W(e)&&(r="leading"in e?!!e.leading:r,o="trailing"in e?!!e.trailing:o),M(t,n,{leading:r,maxWait:n,trailing:o})};function H(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]}function L(t){return Object.prototype.toString.call(t).slice(8,-1)}function U(t){return Array.isArray(t)?t:[t]}function V(t){return Array.isArray(t)&&1===t.length?t[0]:t}function z(t,n){return t.debounce>0?O(n,t.debounce):t.throttle>0?C(n,t.throttle):n}function B(t,n,e){return t.map((function(t){var r,o={};if(t.type===_.string)"object"==typeof e&&null!==e&&(o=e),t.args[0].params=Object.assign({},n.params,o);else if(t.type===_.functional)t.args=[],(r=t.args).push.apply(r,u(U(e),U(n.params)));else if(t.type===_.axios){"object"==typeof e&&null!==e&&(o=e);var a=t.args[0].method?t.args[0].method.toLocaleUpperCase():"GET";"GET"===a?(t.args[0].params=Object.assign({},n.params,t.args[0].params?t.args[0].params:{},o),t.args[0].method="GET"):"POST"===a&&(t.args[0].data=Object.assign({},n.params,t.args[0].data?t.args[0].data:{},o))}return t}))}function J(t,n){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var e,r,o,i,c,s,f;return a(this,(function(a){switch(a.label){case 0:if(e={data:null,error:null},"AsyncFunction"!==L(t))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),r=e,[4,t.apply(void 0,u(n))];case 2:return r.data=a.sent(),[3,4];case 3:return o=a.sent(),e.error=o,[3,4];case 4:return[3,10];case 5:return a.trys.push([5,9,,10]),i=t.apply(void 0,u(n)),c=e,function(t){return"Promise"===L(t)||"Function"===L(t)&&"Function"===L(t.then)&&"Function"===L(t.catch)}(i)?[4,i]:[3,7];case 6:return s=a.sent(),[3,8];case 7:s=i,a.label=8;case 8:return c.data=s,[3,10];case 9:return f=a.sent(),e.error=f,[3,10];case 10:return[2,e]}}))}))}function Q(t){return new Promise((function(n){!function(t,n,e){if(0===t.length)return e(null,t);var r=new Array(t.length),o=0,a=!1;t.forEach((function(i,u){n(i,(function(n,i){if(!a)return n?(a=!0,e(n,null)):(r[u]=i,(o+=1)===t.length?e(null,r):void 0)}))}))}(t,(function(t,n){J(t.fn,t.args).then((function(t){var e=t.data,r=t.error;n(r,e)}))}),(function(t,e){n({data:e,error:t})}))}))}function X(t){return o(this,void 0,void 0,(function(){var n,e,r,o,i,u,c;return a(this,(function(a){switch(a.label){case 0:n={data:null,error:null},e=t.slice(),r=e.shift(),o=!1,a.label=1;case 1:return!r||o?[3,3]:[4,J(r.fn,r.args)];case 2:return i=a.sent(),u=i.data,(c=i.error)&&(o=!0,n.error=c,n.data=null),n.data=u,(r=e.shift())&&(r.args=[u]),[3,1];case 3:return[2,n]}}))}))}function Y(t,n){return void 0===n&&(n=I.async),o(this,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:return e={data:null,error:null},n!==I.async?[3,2]:[4,Q(t)];case 1:return e=r.sent(),[3,4];case 2:return[4,X(t)];case 3:e=r.sent(),r.label=4;case 4:return[2,e]}}))}))}!function(t){t.normal="normal",t.debounce="debounce",t.throttle="throttle"}(R||(R={})),function(t){t.async="async",t.asynchronous="asynchronous"}(I||(I={})),function(t){t.string="string",t.axios="axios",t.functional="functional"}(_||(_={}));var Z=Object.create(null);t.useRequest=function(t,i){var c=this;void 0===i&&(i={});var s,f,l=function(t){return(Array.isArray(t)?u(t):[t]).map((function(t){return"string"==typeof t?{fn:e,args:[{url:t,method:"GET"}],ctx:null,type:_.string}:"function"==typeof t?{fn:t,args:[],ctx:null,type:_.functional}:{fn:e,args:[t],ctx:null,type:_.axios}}))}(t),y=(f=[{fn:V,ctx:null,args:[]}],"function"==typeof(s=i).format&&f.push({fn:s.format,args:[],ctx:null}),{manual:s.manual||!1,onSuccess:s.onSuccess||H,onError:s.onError||H,loading:s.loading||!1,data:s.data||null,params:s.params||[],throttle:s.throttle||0,debounce:s.debounce||0,format:f,async:"boolean"!=typeof s.async||s.async,cacheKey:s.cacheKey||"",key:"function"==typeof s.key?s.key:null,refreshDeps:Array.isArray(s.refreshDeps)?s.refreshDeps:null}),d=n.reactive({loading:y.loading,data:y.data,error:null,fetches:{}}),p=function(t,n){return o(c,void 0,void 0,(function(){var e;return a(this,(function(r){return y.key?n&&(e=d.fetches[n]||{loading:!1,data:null,error:null},d.fetches[n]=Object.assign(e,{loading:t})):d.loading=t,[2]}))}))},h=function(t){return o(c,void 0,void 0,(function(){var n,e;return a(this,(function(r){switch(r.label){case 0:return y.key?[4,J(y.key,U(t))]:[3,2];case 1:if(n=r.sent(),e=n.data,null===n.error&&"string"==typeof e&&e)return[2,e];throw Error("key function return no a string");case 2:return[2,""]}}))}))},v=function(t,n){return o(c,void 0,void 0,(function(){var e,r;return a(this,(function(o){switch(o.label){case 0:return y.format[0].args=[t.data],[4,Y(y.format,I.asynchronous)];case 1:return e=o.sent(),y.key?n&&(r=d.fetches[n]||{loading:!1,data:null,error:null},d.fetches[n]=Object.assign(r,{data:e.data,error:t.error})):(d.data=e.data,d.error=t.error,y.cacheKey&&(Z[y.cacheKey]=d.data)),t.error?y.onError(d.error):y.onSuccess(d.data),[4,p(!1,n)];case 2:return o.sent(),[2,e.data]}}))}))};y.cacheKey&&Object.prototype.hasOwnProperty.call(Z,y.cacheKey)&&(d.data=Z[y.cacheKey]);var b=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o(c,void 0,void 0,(function(){var n,e;return a(this,(function(r){switch(r.label){case 0:return[4,h(t)];case 1:return n=r.sent(),[4,p(!0,n)];case 2:return r.sent(),y.cacheKey&&Object.prototype.hasOwnProperty.call(Z,y.cacheKey)&&(d.data=Z[y.cacheKey]),[4,Y(B(l,y,t),y.async?I.async:I.asynchronous)];case 3:return e=r.sent(),[4,v(e,n)];case 4:return[2,r.sent()]}}))}))},g={};return!1===y.manual?b(y.params):Object.assign(g,{run:z(y,b),cancel:function(){return o(c,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))}}),y.refreshDeps&&!1===y.manual&&n.watch(y.refreshDeps,(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];b()})),r(r({},n.toRefs(d)),g)},Object.defineProperty(t,"__esModule",{value:!0})}));
